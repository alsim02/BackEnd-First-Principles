# Appunti: Validations & Transformations

## 1. Introduzione
- Validations e transformations sono fondamentali per garantire integrità e sicurezza dei dati in un’app backend.
- Si applicano principalmente all’ingresso dati verso la controller layer, prima di eseguire logica di business.

## 2. Architettura tipica backend e dove si applicano
- Repository layer: interagisce con database o storage.
- Service layer: esegue logica di business.
- Controller layer: gestisce la richiesta HTTP, chiama il service layer e formatta la risposta.
- Validations e transformations avvengono subito dopo il routing e prima dell’esecuzione del service layer, spesso in middleware o pipeline dedicate.

## 3. Perché validare e trasformare i dati
- Client globali possono inviare dati malformati, incompleti o pericolosi.
- Validazione verifica che i dati rispettino formato, restrizioni e logica attesa.
- Transformation adatta/corrige dati per semplificare la logica di business (es. casting tipi, normalizzazione).

## 4. Validazione: cosa e come verificare
- Controllo che i payload (JSON, query params, path params, headers) siano completi, del tipo e formato atteso, senza dati indesiderati.
- Anche dati provenienti da client affidabili devono essere validati per sicurezza e robustezza.

## 5. Esempio di validazione
- Campo "name" deve essere stringa, lunghezza fra 5 e 100 caratteri.
- Se mancante o non valido, si risponde con errore 400 Bad Request.
- Validazione precoce evita errori in logica di business o database.

## 6. Tipi di validazione
- **Syntactic validation:** verifica la sintassi di dati specifici, es. formato email, telefono, data.
- **Semantic validation:** verifica senso e coerenza del dato, es. data di nascita non può essere futura, età plausibile.
- **Type validation:** conferma che il dato rispetti il tipo atteso (stringa, numero, booleano, array, oggetto).

## 7. Trasformazione: cosa è e perché serve
- Modifica dati in ingresso per adattarli al formato atteso dal backend.
- Esempi: convertire stringa di un numero in tipo numerico, normalizzare email a minuscolo, aggiungere prefissi a numeri di telefono.
- Fa parte della pipeline di validazione, facilitando la successiva elaborazione.

## 8. Esempi pratici di trasformazioni e validazioni
- Query param “page” e “limit” arrivano come stringhe; trasformati in numeri prima della validazione.
- Email inviata con maiuscole viene trasformata in minuscole.
- Numero di telefono viene formattato aggiungendo prefissi.

## 9. Validazioni complesse
- Validazioni condizionali e basate su relazioni logiche tra campi.
- Esempio: campi password e conferma password devono coincidere.
- Campo "partner" obbligatorio solo se "married" è true.

## 10. Coordinamento validazione tra frontend e backend
- Frontend valida per migliorare esperienza utente, mostrando errori immediati.
- Backend deve sempre validare e trasformare per sicurezza e integrità, non può affidarsi solo al frontend.
- Diversi client (Web, API, mobile) possono interagire con il backend; la validazione server-side è imprescindibile.

## 11. Vantaggi delle validazioni server-side
- Evita crash del server e errori di database causati da dati malformati.
- Garantisce che la logica di business riceva dati affidabili.
- Restituisce messaggi di errore chiari e coerenti al client.

---

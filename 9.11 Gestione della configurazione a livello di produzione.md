# Appunti: Gestione della configurazione a livello di produzione

## 1. Cos’è la gestione della configurazione
- Processo sistematico per organizzare, memorizzare e accedere a tutte le impostazioni di un’app backend.
- Configurazioni sono il "DNA" dell’applicazione, influenzano comportamento e funzionamento in ogni ambiente.

## 2. Oltre le credenziali
- La gestione config non è solo salvare password, chiavi API o URL di database.
- Comprende anche logging, metriche di performance, feature flags, tuning di performance, regole di business, ecc.

## 3. Esempio: piattaforma e-commerce
- Config può includere timeout, host, porta, API key di servizi esterni (es. Stripe), flag per abilitare/disabilitare funzionalità.
- Le feature flags servono per l’abilitazione selettiva di funzionalità (es. rollout graduale di checkout).

## 4. Diverse caratteristiche delle config
- Sensibilità: alcune config sono segrete, altre no.
- Frequenza di cambio: config che cambiano spesso o raramente.
- Uniformità: config uguali o diverse tra development, staging e produzione.

## 5. Sfida nelle architetture distribuite
- Backend moderno è un sistema distribuito: molteplici servizi, database, cache, code, integrazioni esterne.
- Gestire centralmente le config diventa critico per evitare confusione, incoerenza, vulnerabilità e difficoltà di debug.

## 6. Chaos da cattiva gestione config
- Spargimento di valori hardcoded nel codice.
- Comportamenti inconsistenti tra ambienti.
- Esposizione di segreti e problemi di sicurezza.
- Difficoltà nel riprodurre problemi in produzione.

## 7. Tipi di configurazioni
- **Settings applicativi:** log level, porta, pool database, timeout.
- **Configurazioni database:** host, porta, utente, password, nome db.
- **Servizi esterni:** API key per email, pagamenti, autenticazione.
- **Feature flags:** abilitazione dinamica funzionalità per gruppi utenti.
- **Config infra e sicurezza:** JWT secret, session timeout, parametri di tuning.
- **Regole di business:** configurazioni di limiti o politiche applicative.

## 8. Tipi di storage per le configurazioni
- **Variabili d’ambiente:** standard più comune, gestite localmente o da cloud/containers.
- **File di config:** JSON, YAML (preferito per supporto commenti), TOML.
- **Key-Value store:** lightweight, semplice, simile a env variables.
- **Provider cloud dedicati:** HashiCorp Vault, AWS Parameter Store, Azure Key Vault, Google Secret Manager.
- Strategie ibride: combinare più fonti con priorità e condizioni basate su ambiente.

## 9. Configurazioni diverse per ambiente
- Dev: focus su produttività e debugging.
- Test: automatizzazione e QA.
- Staging: riproduzione ambiente produzione.
- Produzione: affidabilità, sicurezza, performance.
- Config cambiano tra ambienti per riflettere queste priorità senza modificare il codice applicativo.

## 10. Sicurezza nella gestione config
- Non hardcodare mai segreti nel codice.
- Preferire provider dedicati per la gestione sicura e criptata di API keys, secret, password.
- Applicare principio del minimo privilegio negli accessi alle config.
- Ruotare le chiavi e segreti periodicamente.

## 11. Validazione delle configurazioni
- Cruciale verificare che tutte le configurazioni necessarie siano presenti e valide all’avvio dell’app.
- Usare librerie di validazione (es. Zod per TypeScript, Go Validator) per garantire correttezza e completezza.
- Fail fast se configurazioni obbligatorie mancano, per evitare errori runtime difficili da diagnosticare.

---
